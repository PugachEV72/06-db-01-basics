# Домашнее задание к занятию 1. «Типы и структура СУБД» - Пугач Евгений.


---

## `Задание 1`

Какой тип БД лучше выбрать для хранения определённых данных:
- электронные чеки в json-виде,
- склады и автомобильные дороги для логистической компании,
- генеалогические деревья,
- кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации,
- отношения клиент-покупка для интернет-магазина.

### Ответ:

- документоориентированная (NoSQL) СУБД, так как каждый чек - это отдельный документ. Можно  
  использовать MongoDB, так как документы в ней возможно хранить в JSON;
- графовая (NoSQL) СУБД. Склады - это узлы, а дороги между складами - это рёбра. У рёбер могут  
  быть свойства - расстояние между складами, стоимость проезда для автомобилей разного типа и  
  так далее. Граф предоставляет возможность поиска оптимального пути для решений задачи  
  логистической компании, т.к. цель - оптимизация пути от точки А до точки Б;
- сетевая (NoSQL) СУБД, так как древовидная структура и узлы древа связаны между собой в  
  отношениях родитель-потомок. У потомка может быть 2 или больше родителей и нельзя хранить их  
  в одной ячейке;
- (NoSQL) СУБД типа ключ-значение, которая позволяет хранить значения установленное количество  
  времени. Можно использовать Memcached, в котором есть настройка TTL;
- реляционная (SQL) СУБД с таблицами фактов (заказы) и измерений (клиенты, товары, продавцы),  
  к тому же табличное решение имеет возможность дальнейшего развития, можно использовать Postgres.

---

## `Задание 2`

Какой классификации по CAP-теореме соответствует ваша система, если:
- данные записываются на все узлы с задержкой до часа (асинхронная запись);
- при сетевых сбоях система может разделиться на 2 раздельных кластера;
- система может не прислать корректный ответ или сбросить соединение.
Согласно PACELC-теореме как бы вы классифицировали эти реализации?

### Ответ:

- CAP: AP, так как асинхронность исключает согласованность. PACELC: PA/EL;
- CAP: AP, так как 2 раздельных кластерах без сетевого соединения исключают согласованность. PACELC: PA/EC;
- CAP: CP, так как данные согласованы, но есть проблемы с доступностью. PACELC: PC/EC.


---

## `Задание 3`

### Ответ:

Не могут, так как эти принципы противоречат друг другу. ACID - согласованность важнее производительности,  
BASE - производительность важнее согласованности. Но существует MongoDB, которая стремиться соответствовать  
обоим принципам.

---

## `Задание 4`

Вам дали задачу написать системное решение, основой которого бы послужили:
- фиксация некоторых значений с временем жизни,
- реакция на истечение таймаута.

### Ответ:

Наиболее подходящим решением в данной ситуации будет Redis. Redis это key-value хранилище, имеет  
механизм Pub/Sub и TTL с возможностью реакции на его истечение.
Недостатки Redis:
- размер БД ограничен доступной памятью RAM;
- Не является реляционной БД, не поддерживает SQL;
- в случае отказа сервера, данные из оперативной памяти будут утеряны и сохранятся только данные последней  
  синхронизации с диском, если такая возможность не была отключена;
- отсутствует разграничение прав доступа по пользователям;
- работает только на одном ядре процессора в однопоточном режиме.

---

## `Доработка:`

Из недостатков необходимо удалить утверждение об однопоточном режиме работы, так как начиная с версии 4.0,  
Redis начал реализовывать многопоточные действия.  

Основным недостатком на данный момент является то, что экземпляр Redis, доступный в сети Интернет без какой-либо  
защиты, очень легко взломать. По умолчанию Redis привязывается ко всем интерфейсам и вообще не использует  
аутентификацию, что является серьезной проблемой безопасности. Чтобы быть уверенным в защите рабочей среды  
должным образом, необходимо произвести необходимые шаги для повышения безопасности.  

Также, если использовать хранение данных, при перезагрузке необходимо время, чтобы Redis загрузил данные в  
память и чем больше данных, тем дольше он отбрасывает коннекты к базе, что значительно увеличивает время отклика.  
Например, rdb-файл размером 30Гб, будет грузиться около 15 минут и все это время Redis работать не будет.  
 
Также, при использовании хранения данных, необходимо иметь, как минимум, двойной запас места от текущего размера  
данных в памяти, иначе, в момент форка (неважно rdb или aof) может закончится место на диске, потому как в этот  
момент создается temp-файл, куда скидываются данные и только после этого удаляется старый файл.

---

